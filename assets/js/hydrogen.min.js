jQuery(function(e){function a(){let e=[{display_name:"Plugin",variable_name:"plugin",value:"woo-hydrogen"}];return wc_hydrogen_params.meta_order_id&&e.push({display_name:"Order ID",variable_name:"order_id",value:wc_hydrogen_params.meta_order_id}),wc_hydrogen_params.meta_name&&e.push({display_name:"Customer Name",variable_name:"customer_name",value:wc_hydrogen_params.meta_name}),wc_hydrogen_params.meta_email&&e.push({display_name:"Customer Email",variable_name:"customer_email",value:wc_hydrogen_params.meta_email}),wc_hydrogen_params.meta_phone&&e.push({display_name:"Customer Phone",variable_name:"customer_phone",value:wc_hydrogen_params.meta_phone}),wc_hydrogen_params.meta_billing_address&&e.push({display_name:"Billing Address",variable_name:"billing_address",value:wc_hydrogen_params.meta_billing_address}),wc_hydrogen_params.meta_shipping_address&&e.push({display_name:"Shipping Address",variable_name:"shipping_address",value:wc_hydrogen_params.meta_shipping_address}),wc_hydrogen_params.meta_products&&e.push({display_name:"Products",variable_name:"products",value:wc_hydrogen_params.meta_products}),e}function r(){let e={};return wc_hydrogen_params.card_channel&&(wc_hydrogen_params.banks_allowed&&(e.banks=wc_hydrogen_params.banks_allowed),wc_hydrogen_params.cards_allowed&&(e.card_brands=wc_hydrogen_params.cards_allowed)),e}function n(a,r){let n=`
        <style>
        /* Style the modal overlay to cover the entire screen */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5); /* Semi-transparent background */
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Style the modal container */
        .hydrogen-modal-container {
            background: #fff; /* White background color */
            border-radius: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3); /* Drop shadow */
        position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          max-width: 1000px!important;
          z-index: 1001;
        }

        /* Style the modal content */
        .modal-content {
            padding: 20px;
        }
        </style>
        <div class="modal-overlay">
        <div class="hydrogen-modal-container">
            <div class="modal fade" id="customModalSuccess" tabindex="-1" aria-labelledby="customModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="hydrogen-modal-body">
                            <p>${a}</p>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" data-dismiss="modal" id="okButton">OK</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </div>
        `;e("body").append(n),e("#okButton").on("click",function(){window.location.href=r})}function t(){let e=[];return wc_hydrogen_params.bank_channel&&e.push("bank"),wc_hydrogen_params.card_channel&&e.push("card"),wc_hydrogen_params.ussd_channel&&e.push("ussd"),wc_hydrogen_params.qr_channel&&e.push("qr"),wc_hydrogen_params.bank_transfer_channel&&e.push("bank_transfer"),e}async function o(){e("#wc-hydrogen-form").hide();let a;e("form#payment-form, form#order_review").find("input.hydrogen_txnref").val("");let o=Number(wc_hydrogen_params.amount);wc_hydrogen_params.meta_order_id;let i=window.location.href;function d(){k.click(),window.location.href="/cart"}window.obj={amount:o,email:wc_hydrogen_params.email,currency:wc_hydrogen_params.currency,description:"Payment for items ordered with ID "+wc_hydrogen_params.meta_order_id,meta:wc_hydrogen_params.meta_name,callback:i,isAPI:!1},window.token=wc_hydrogen_params.key,Array.isArray(t())&&t().length&&(paymentData.channels=t(),e.isEmptyObject(r())||(paymentData.metadata.custom_filters=r()));var s=new URLSearchParams(window.location.search),l=s.get("TransactionRef");s.get("key");var c=window.location.href,m=c.indexOf("key=");if(-1!==m){var u=c.substring(m),p=u.indexOf("?");-1!==p&&(u=u.substring(0,p)),u.split("=")[1]}if(!l){var f=window.location.href,h=f.lastIndexOf("?");if(-1!==h)for(var y=f.substring(h+1).split("&"),v=0;v<y.length;v++){var b=y[v].split("=");if("TransactionRef"===b[0]){l=b[1];break}}}if(l){if(window!==window.parent)window.parent.postMessage({TransactionRef:l},"*");else{wc_hydrogen_params.meta_order_id,wc_hydrogen_params.hydrogen_wc_redirect_url;var g=window.location.href.replace(/\/checkout\/order-pay\/\d+\/.*/,"");g+="/cart/",transactionRef=l,w()}}else{async function $(){try{let e=await handlePgData(window.obj,window.token);console.log("return transaction ref",e),transactionRef=e,window.innerWidth>768&&function e(){let a=document.getElementById("modal");a.style.height="auto"}()}catch(a){console.error("Error occurred:",a)}}$()}var k=document.querySelector(".modal .close");function w(){let a;a=`
            <style>
                /* Style for the spinner overlay */
                .spinner-overlay {
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(255, 255, 255, 0.8); /* Semi-transparent white background */
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 9999; /* Ensure it's above other elements */
                }
    
                /* Style for the spinner */
                .spinner {
                    border: 4px solid rgba(0, 0, 0, 0.1);
                    border-top: 4px solid #3498db; /* Blue color for spinner */
                    border-radius: 50%;
                    width: 40px;
                    height: 40px;
                    animation: spin 1s linear infinite; /* Animation for rotation */
                }
    
                @keyframes spin {
                    0% { transform: rotate(0deg); }
                    100% { transform: rotate(360deg); }
                }
            </style>
            <div id="loading-spinner" class="spinner-overlay">
                <div class="spinner"></div>
            </div>
        `,e("body").append(a),e("#wc-hydrogen-form").show();var r=wc_hydrogen_params.meta_order_id;e.ajax({url:"/wc-api/wc_gateway_hydrogen_popup",method:"POST",data:{transactionRef:JSON.stringify(transactionRef),hydrogenOderId:r},dataType:"json",beforeSend:function(){},success:function(e){var a=wc_hydrogen_params.meta_order_id,r=window.location.href.replace(/\/checkout\/order-pay\/\d+\/.*/,"");if(r+="/cart/","90000"==e.statusCode){var t="Your payment for order #"+a+" is successful and confirmed! Check your email or account for order details.";n(t,r)}else{var t="Your payment for order #"+a+" was declined with status: Failed ! Click Ok.";n(t,r)}},error:function(e,a,r){console.log("Error:",a,r)},complete:function(){e("#loading-spinner").remove()}})}k.addEventListener("click",w),window.addEventListener("message",function(e){e.data&&e.data.TransactionRef&&k.click()})}e("#wc-hydrogen-form").hide(),o(),e("#hydrogen-payment-button").click(function(){o()}),e("#hydrogen_form form#order_review").submit(function(){o()})});